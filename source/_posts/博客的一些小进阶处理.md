---
title: 博客的一些小进阶处理
date: 2020-12-27 17:00:40
tags: 
 - 博客
 - 设置
 - 其他
---

## 前言

应我朋友要求，写一些搭建完博客后的设置。注意，本教程不包含如何搭建博客教程（写过，但是丢失了，不想再写一次）以及如何安装搭建博客使用的工具（如Git Bash），默认已经搭建完博客并拥有工具，只有一些方便更新博客的技巧。

<!-- more -->

## 无需密码的推送

首先查看自己电脑是否生成过SSH密钥，路径是`C:\Users\电脑用户名\.ssh`，查看是否有**id_rsa、id_rsa.pub**文件，如果没有则需要生成，如果有则跳过生成步骤

### 生成SSH KEY

打开`Git Bash`，输入指令

```bash
ssh-keygen -t rsa -C "youremail@example.com"
```

-t 参数指定密钥类型，如果没有指定则默认生成用于SSH-2的rsa密钥，这里使用的就是rsa。

-C 参数来指定一个注释，可以方便用户标识这个密钥，没有硬性规定需要输入什么，不加也行，但是推荐输入github注册邮箱，防止一些奇奇怪怪的问题。

按回车开始创建，它会让你设置密码，回车即可，不要设置密码

这样就创建完了，密钥存储的位置在`C:\Users\电脑用户名\.ssh`这里，带.pub后缀的是公钥，不带的是私钥。密钥的打开可以使用vscode，sublime Text，记事本之类的。

### 将密钥上传至github/gitee

打开github，点击右上角的个人，进入设置

![](/博客的一些小进阶处理/1.png)

然后选择SSH and GPG keys选项，点击New SSH key

![](/博客的一些小进阶处理/2.png)

在SSH创建页面输入SSH的title，这个随便你取，让自己知道这个SSH是干嘛的就行了，在key中把刚才创建的**公钥**复制进去，点击Add SSH key就可以了。

![](/博客的一些小进阶处理/3.png)

Gitee过程也基本一致，右上角个人头像 -> 设置 -> 安全设置 -> SSH公钥

### 验证

使用下面的指令进行验证是否配置成功

```bash
ssh -T git@github.com # 什么都不用改，直接在git输入就行
```

如果出现类似下图即代表配置成功，以后更新博客就不用输入账号密码了（配置完第一次可能需要，如果不需要就当我记错了）

![](/博客的一些小进阶处理/4.png)

也可以顺便配置一下这两个东西，这个东西是来设置Git的使用者，个人理解是使用Git更新博客的时候，更新者的信息（百度也没找到比较正面的回答）

```bash
git config --global user.name "xxx"            // 推荐你的github用户名
git config --global user.email  "xxx@qq.com"   // 推荐你的github注册邮箱
```

### 修改配置文件

修改位于博客根目录下的_config.yml文件，在最后面的deploy设置如下。这一步我不记得搭建博客过程中是否设置过了，这边就再提一下。我这里是每一次更新都同时更新 github 和 gitee 。

![](/博客的一些小进阶处理/5.png)

## 博客源代码备份

一般搭建的博客，存储在仓库上的不是博客的原始数据，只是一些静态页面。所以如果你电脑和我一样，出现问题本地数据丢了，就找不回来了，所以最好是备份一下原始数据。

我是使用插件`hexo-git-backup`来备份我的源数据。

### backup的安装

先贴一下GitHub上面的地址，[backup地址](https://github.com/coneycode/hexo-git-backup)，如果怕我说的有什么问题可以直接去GitHub上看。

使用下面指令查看hexo版本

```bash
hexo -v
```

![](/博客的一些小进阶处理/6.png)

根据你hexo的版本来执行指令，如果没显示hexo的版本（如图只显示hexo-cil版本，则当做3.x.x版本以上）

```bash
npm install hexo-git-backup@0.0.91 --save # hexo版本为2.x.x，执行这个
```

```bash
npm install hexo-git-backup --save        # hexo版本为3.x.x，执行这个
```

### 修改配置文件

修改位于博客根目录下的_config.yml文件，添加以下内容配置

```yaml
backup:
    type: git
    message: Back up blog
    repository:
       github: git@github.com:Jeislu/Jeislu.github.io.git,backup
       gitee: git@gitee.com:jeislu/jeislu.git,backup
```

其中的 `git@github.com:Jeislu/Jeislu.github.io.git` 和 `git@gitee.com:jeislu/jeislu.git `替换成你自己仓库的，仓库后面的backup代表创建了一个backup分支，原始数据就保存在这里。

![](/博客的一些小进阶处理/7.png)

然后你就可以使用下面这条指令来备份你的数据了

```bash
hexo backup           # 也可以简写为hexo b
```

插件还有其他功能设置，如果需要可以自己去查看。

## 自动更新

每一次写完博客都需要自己手动输入几条指令去更新备份，有时候还经常要忘。所以最好的方法就是设个定时任务每天自动更新。

### 指令整合

首先需要知道，如果一个文件的后缀是.sh，那么你双击它的时候默认是使用git bash打开（bat默认是cmd/PowerShell）。所以只需要创建一个.sh文件，然后把所有需要执行的指令丢进去就可以了。

这是我自己写的指令合集，极其简单。修改文件内容的时候可别双击打开，右键用记事本打开。

```bash
# 自动推送
# 先进入博客目录，根据你自己的情况更改
cd D:/Study/Blog
# 更新博客三件套
hexo clean
hexo g
hexo d
# 备份博客
hexo backup
```

以后如果想更新备份博客，双击这个这个文件就可以

### 设置windows定时任务

打开控制面板，搜索计划任务，然后打开

![](/博客的一些小进阶处理/8.png)

创建一个基本任务

![](/博客的一些小进阶处理/9.png)

接下来只说一个比较关键的操作（操作选择启动程序），设置脚本（指令集合）的位置（记得先把脚本放好，如果你后面更改位置可能会影响这个任务的执行）

![](/博客的一些小进阶处理/11.png)

然后就完成了，很简单。虽然我不是用基本任务创建的，但是功能上应该是一样的。不过如果你想要更详细的设置，可以选择基本任务下面的创建任务，这个选项可以设置其他一些东西。

## 结尾

基本就这些了，如果本文哪里有问题，欢迎联系我（左边的qq）。